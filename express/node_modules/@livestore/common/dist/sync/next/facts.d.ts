import type { EventDefFacts, EventDefFactsGroup, EventDefFactsSnapshot, FactsCallback } from '../../schema/EventDef.js';
import type * as EventSequenceNumber from '../../schema/EventSequenceNumber.js';
import { type HistoryDag, type HistoryDagNode } from './history-dag-common.js';
export declare const factsSnapshotForEvents: (events: HistoryDagNode[], endEventSequenceNumber: EventSequenceNumber.EventSequenceNumber) => EventDefFactsSnapshot;
export declare const factsSnapshotForDag: (dag: HistoryDag, endEventSequenceNumber: EventSequenceNumber.EventSequenceNumber | undefined) => EventDefFactsSnapshot;
export type FactValidationResult = {
    success: true;
} | {
    success: false;
    /** Index of the item that caused the validation to fail */
    index: number;
    requiredFacts: EventDefFacts;
    mismatch: {
        existing: EventDefFacts;
        required: EventDefFacts;
    };
    currentSnapshot: EventDefFacts;
};
export declare const validateFacts: ({ factGroups, initialSnapshot, }: {
    factGroups: EventDefFactsGroup[];
    initialSnapshot: EventDefFactsSnapshot;
}) => FactValidationResult;
export declare const applyFactGroups: (factGroups: EventDefFactsGroup[], snapshot: EventDefFactsSnapshot) => void;
export declare const applyFactGroup: (factGroup: EventDefFactsGroup, snapshot: EventDefFactsSnapshot) => void;
/** Check if groupA depends on groupB */
export declare const dependsOn: (groupA: EventDefFactsGroup, groupB: EventDefFactsGroup) => boolean;
export declare const replacesFacts: (groupA: EventDefFactsGroup, groupB: EventDefFactsGroup) => boolean;
export declare const isSameMapByKey: (set: EventDefFacts, otherSet: EventDefFacts) => boolean;
export declare const factsToString: (facts: EventDefFacts) => string;
export declare const factsIntersect: (setA: EventDefFacts, setB: EventDefFacts) => boolean;
export declare const getFactsGroupForEventArgs: ({ factsCallback, args, currentFacts, }: {
    factsCallback: FactsCallback<any> | undefined;
    args: any;
    currentFacts: EventDefFactsSnapshot;
}) => EventDefFactsGroup;
export declare const compareEventSequenceNumbers: (a: EventSequenceNumber.EventSequenceNumber, b: EventSequenceNumber.EventSequenceNumber) => number;
//# sourceMappingURL=facts.d.ts.map