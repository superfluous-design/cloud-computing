{"version":3,"file":"tracer.js","names":["OtelApi","Cause","Context","Effect","dual","Layer","Option","EffectTracer","Resource","nanosToHrTime","recordToAttributes","unknownToAttributeValue","OtelSpanTypeId","Symbol","for","kindMap","SpanKind","INTERNAL","CLIENT","SERVER","PRODUCER","CONSUMER","OtelSpan","name","parent","context","links","kind","_tag","span","spanId","traceId","attributes","Map","sampled","status","constructor","contextApi","tracer","startTime","active","startSpan","length","map","link","makeSpanContext","undefined","populateContext","value","trace","deleteSpan","spanContext","traceFlags","TraceFlags","SAMPLED","attribute","key","setAttribute","set","addLinks","push","end","endTime","exit","hrTime","setStatus","code","SpanStatusCode","OK","isInterruptedOnly","cause","message","pretty","firstError","prettyErrors","stack","renderErrorCause","recordException","ERROR","event","addEvent","TracerProvider","GenericTag","Tracer","make","slice","execution","fiber","currentSpan","with","traceFlagsTag","traceStateTag","makeExternalSpan","options","empty","add","traceState","match","createTraceState","onNone","onSome","currentOtelSpan","flatMap","succeed","fail","NoSuchElementException","layerGlobalProvider","sync","getTracerProvider","layerTracer","effect","zip","resource","provider","getTracer","layerGlobalTracer","pipe","provide","layerGlobal","unwrapEffect","setTracer","provideMerge","layerWithoutOtelTracer","layer","liftThrowable","otelContext","setSpan","setSpanContext","isRemote","getOrElse","extractTraceTag","getOption","getOrUndefined","tag","orElse","withSpanContext","withParentSpan"],"sources":["../../../src/internal/tracer.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}