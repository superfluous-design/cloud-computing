{"version":3,"file":"NodeSocket.js","names":["Socket","_interopRequireWildcard","require","Channel","Context","Deferred","Effect","FiberSet","Layer","Scope","Net","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","NetSocket","exports","GenericTag","makeNet","options","fromDuplex","acquireRelease","async","resume","conn","createConnection","on","removeAllListeners","succeed","cause","fail","SocketGenericError","reason","sync","destroy","closed","destroySoon","open","withFiberRuntime","fiber","currentSocket","latch","unsafeMakeLatch","openContext","currentContext","run","handler","scopedWith","fnUntraced","scope","fiberSet","make","pipe","extend","provideService","runtime","onData","chunk","result","isEffect","onEnd","unsafeDone","deferred","void","onError","onClose","hadError","SocketCloseError","code","addFinalizer","off","join","mapInputContext","input","merge","ensuring","unsafeClose","undefined","interruptible","write","whenOpen","isCloseEvent","Error","writer","writableEnded","end","of","TypeId","runRaw","makeNetChannel","unwrapScoped","map","toChannelWith","layerNet","effect"],"sources":["../../src/NodeSocket.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}