{"version":3,"file":"NodeSocketServer.js","names":["Socket","_interopRequireWildcard","require","SocketServer","Context","Effect","Exit","FiberRef","FiberSet","_Function","Layer","Scope","Net","WS","NodeSocket","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","IncomingMessage","Tag","exports","make","fnUntraced","options","server","acquireRelease","sync","createServer","async","resume","close","void","once","cause","fail","SocketServerError","reason","listen","run","handler","scope","fiberSet","pipe","extend","runtime","onConnection","conn","fromDuplex","succeed","closed","destroySoon","flatMap","catchAllCause","reportUnhandledError","provideService","NetSocket","_resume","on","off","ensuring","address","of","_tag","path","hostname","port","layer","scoped","makeWebSocket","WebSocketServer","error","req","fromWebSocket","WebSocket","layerWebSocket","withFiberRuntime","fiber","unhandledLogLevel","getFiberRef","unhandledErrorLogLevel","logWithLevel","value"],"sources":["../../src/NodeSocketServer.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}