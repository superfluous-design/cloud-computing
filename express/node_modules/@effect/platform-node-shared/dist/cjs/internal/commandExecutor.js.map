{"version":3,"file":"commandExecutor.js","names":["Command","_interopRequireWildcard","require","CommandExecutor","FileSystem","Deferred","Effect","_Function","Inspectable","Layer","Option","Sink","Stream","ChildProcess","_error","_sink","_stream","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","inputToStdioOption","stdin","outputToStdioOption","output","toError","err","globalThis","Error","String","toPlatformError","method","error","command","flattened","flatten","reduce","acc","curr","args","join","length","handleErrnoException","ProcessProto","ProcessTypeId","BaseProto","toJSON","_id","pid","runCommand","fileSystem","_tag","spawn","flatMap","make","exitCode","async","resume","handle","stdio","stdout","stderr","cwd","getOrElse","constUndefined","shell","env","process","fromEntries","on","fail","unsafeDone","succeed","sync","kill","pipe","match","onNone","void","onSome","dir","access","zipRight","acquireRelease","isDone","done","suspend","await","map","exitCodeDeferred","drain","fromWritable","code","signal","ExitCode","isRunning","negate","asVoid","ProcessId","fromReadable","transduce","assign","create","identity","tap","forkDaemon","run","head","tail","slice","initial","last","stream","unwrapScoped","layer","exports","effect","makeExecutor"],"sources":["../../../src/internal/commandExecutor.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}