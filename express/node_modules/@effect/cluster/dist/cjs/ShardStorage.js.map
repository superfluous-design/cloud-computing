{"version":3,"file":"ShardStorage.js","names":["Context","_interopRequireWildcard","require","Effect","Layer","MutableHashMap","Option","_Runner","_RunnerAddress","_ShardId","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","ShardStorage","Tag","exports","makeEncoded","fnUntraced","encoded","activeShards","Set","of","getAssignments","map","assignments","Map","shardId","runnerAddress","ShardId","make","none","some","decodeRunnerAddress","saveAssignments","Array","from","isNone","encodeRunnerAddress","value","getRunners","gen","runners","results","length","address","runner","Runner","decodeSync","saveRunners","suspend","encodeSync","acquire","shardIds","refresh","release","delete","pipe","onError","sync","add","releaseAll","clear","layerNoop","acquired","succeed","void","_address","shards","makeMemory","empty","layerMemory","effect","host","port","split","RunnerAddress","Number"],"sources":["../../src/ShardStorage.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}