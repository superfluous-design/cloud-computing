{"version":3,"file":"ShardStorage.js","names":["Context","Effect","Layer","MutableHashMap","Option","Runner","RunnerAddress","ShardId","ShardStorage","Tag","makeEncoded","fnUntraced","encoded","activeShards","Set","of","getAssignments","map","assignments","Map","shardId","runnerAddress","set","make","none","some","decodeRunnerAddress","saveAssignments","Array","from","isNone","encodeRunnerAddress","value","getRunners","gen","runners","results","length","i","address","runner","decodeSync","saveRunners","suspend","encodeSync","acquire","shardIds","refresh","release","delete","pipe","onError","sync","add","releaseAll","clear","layerNoop","acquired","succeed","void","_address","shards","makeMemory","empty","layerMemory","effect","host","port","split","Number"],"sources":["../../src/ShardStorage.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}