{"version":3,"file":"httpServer.js","names":["Cookies","_interopRequireWildcard","require","Etag","FetchHttpClient","Headers","App","IncomingMessage","Server","Error","ServerRequest","Socket","UrlParams","Config","Deferred","Effect","Exit","FiberSet","Inspectable","Layer","Option","Stream","BunContext","Platform","MultipartBun","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","make","options","gen","handlerStack","_request","_server","Response","status","server","Bun","serve","fetch","websocket","open","ws","unsafeDone","data","deferred","succeed","message","run","close","code","closeReason","closeDeferred","defaultCloseCodeIsError","fail","SocketCloseError","reason","void","addFinalizer","sync","stop","address","_tag","port","hostname","httpApp","middleware","runFork","makeRuntime","runtime","app","toHandled","request","response","resolve","makeResponse","handler","Promise","_reject","fiber","provideService","HttpServerRequest","ServerRequestImpl","removeHost","url","signal","addEventListener","interruptAsFork","clientAbortFiberId","once","acquireRelease","push","reload","pop","length","exports","fields","headers","globalThis","isEmpty","cookies","header","toSetCookieHeaders","append","statusText","undefined","method","body","formData","toReadableStreamRuntime","stream","layerServer","scoped","HttpServer","layerContext","mergeAll","layer","layerWeak","layerTest","layerTestClient","pipe","provide","RequestInit","keepalive","provideMerge","layerConfig","flatMap","unwrap","wsDefaultRun","_","buffer","Class","source","bunServer","headersOverride","remoteAddressOverride","TypeId","constructor","toJSON","inspect","_id","originalUrl","modify","remoteAddress","toUpperCase","some","fromNullable","requestIP","fromInput","cachedCookies","parseHeader","cookie","fromReadableStream","cause","RequestError","description","textEffect","text","runSync","cached","tryPromise","try","catch","json","tryMap","JSON","parse","urlParamsBody","URLSearchParams","multipartEffect","multipart","persisted","multipartStream","arrayBufferEffect","arrayBuffer","upgrade","all","makeSemaphore","semaphore","async","resume","success","map","await","write","chunk","sendText","isCloseEvent","sendBinary","writer","runRaw","result","isEffect","forEach","join","onExit","exit","raceFirst","withPermits","encoder","TextEncoder","encode","of","index","indexOf","slice","requestSource","self"],"sources":["../../../src/internal/httpServer.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}