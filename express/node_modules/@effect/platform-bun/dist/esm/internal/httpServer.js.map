{"version":3,"file":"httpServer.js","names":["Cookies","Etag","FetchHttpClient","Headers","App","IncomingMessage","Server","Error","ServerRequest","Socket","UrlParams","Config","Deferred","Effect","Exit","FiberSet","Inspectable","Layer","Option","Stream","BunContext","Platform","MultipartBun","make","options","gen","handlerStack","_request","_server","Response","status","server","Bun","serve","fetch","websocket","open","ws","unsafeDone","data","deferred","succeed","message","run","close","code","closeReason","closeDeferred","defaultCloseCodeIsError","fail","SocketCloseError","reason","void","addFinalizer","sync","stop","address","_tag","port","hostname","httpApp","middleware","runFork","makeRuntime","runtime","app","toHandled","request","response","resolve","makeResponse","handler","Promise","_reject","fiber","provideService","HttpServerRequest","ServerRequestImpl","removeHost","url","signal","addEventListener","interruptAsFork","clientAbortFiberId","once","acquireRelease","push","reload","pop","length","fields","headers","globalThis","isEmpty","cookies","header","toSetCookieHeaders","append","statusText","undefined","method","body","formData","toReadableStreamRuntime","stream","layerServer","scoped","HttpServer","layerContext","mergeAll","layer","layerWeak","layerTest","layerTestClient","pipe","provide","RequestInit","keepalive","provideMerge","layerConfig","flatMap","unwrap","wsDefaultRun","_","buffer","Class","source","bunServer","headersOverride","remoteAddressOverride","TypeId","constructor","toJSON","inspect","_id","originalUrl","modify","remoteAddress","toUpperCase","some","fromNullable","requestIP","fromInput","cachedCookies","parseHeader","cookie","fromReadableStream","cause","RequestError","description","textEffect","text","runSync","cached","tryPromise","try","catch","json","tryMap","JSON","parse","urlParamsBody","URLSearchParams","multipartEffect","multipart","persisted","multipartStream","arrayBufferEffect","arrayBuffer","upgrade","all","makeSemaphore","semaphore","async","resume","success","map","await","write","chunk","sendText","isCloseEvent","sendBinary","writer","runRaw","set","result","isEffect","forEach","join","onExit","exit","raceFirst","withPermits","encoder","TextEncoder","encode","of","index","indexOf","slice","requestSource","self"],"sources":["../../../src/internal/httpServer.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}