{"version":3,"file":"EventLogEncryption.js","names":["Context","Effect","Layer","Redacted","Schema","Entry","EntryId","RemoteEntry","EncryptedEntry","Struct","entryId","encryptedEntry","Uint8ArrayFromSelf","EncryptedRemoteEntry","sequence","Number","iv","EventLogEncryption","Tag","makeEncryptionSubtle","crypto","sync","keyCache","WeakMap","getKey","identity","suspend","has","succeed","get","promise","subtle","importKey","value","privateKey","pipe","tap","key","set","of","encrypt","entries","gen","data","orDie","encodeArray","getRandomValues","Uint8Array","encryptedEntries","Promise","all","map","entry","name","tagLength","decrypt","decryptedData","buffer","decoded","decodeArray","i","remoteSequence","sha256","digest","hash","sha256String","hashArray","Array","from","hashHex","bytes","toString","padStart","join","layerSubtle","effect","globalThis"],"sources":["../../src/EventLogEncryption.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}