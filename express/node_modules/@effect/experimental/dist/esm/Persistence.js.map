{"version":3,"file":"Persistence.js","names":["TypeIdError","KeyValueStore","Context","Duration","Effect","identity","Layer","Option","ParseResult","PrimaryKey","Schema","ErrorTypeId","Symbol","for","PersistenceParseError","make","method","error","reason","message","TreeFormatter","formatIssueSync","PersistenceBackingError","cause","BackingPersistenceTypeId","BackingPersistence","GenericTag","ResultPersistenceTypeId","ResultPersistence","layerResult","effect","gen","backing","of","options","storage","storeId","timeToLive","infinity","parse","key","value","mapError","deserializeExit","_","issue","encode","serializeExit","makeKey","symbol","get","flatMap","match","onNone","succeedNone","onSome","asSome","getMany","keys","map","forEach","result","i","pipe","tapError","remove","option","set","ttl","decode","isZero","void","encoded","isFinite","some","none","clear","layerMemory","sync","stores","Map","getStore","store","undefined","clock","unsafeGet","unsafeCurrentTimeMillis","delete","unsafeTtlToExpires","layerKeyValueStore","prefix","s","try","JSON","catch","Array","isArray","expires","as","ignore","succeed","stringify","u","layerResultMemory","provide","layerResultKeyValueStore","_tag","toMillis"],"sources":["../../src/Persistence.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}