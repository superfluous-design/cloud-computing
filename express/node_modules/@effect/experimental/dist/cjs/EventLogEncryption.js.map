{"version":3,"file":"EventLogEncryption.js","names":["Context","_interopRequireWildcard","require","Effect","Layer","Redacted","Schema","_EventJournal","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","EncryptedEntry","exports","Struct","entryId","EntryId","encryptedEntry","Uint8ArrayFromSelf","EncryptedRemoteEntry","sequence","Number","iv","EventLogEncryption","Tag","makeEncryptionSubtle","crypto","sync","keyCache","getKey","identity","suspend","succeed","promise","subtle","importKey","value","privateKey","pipe","tap","key","of","encrypt","entries","gen","data","orDie","Entry","encodeArray","getRandomValues","Uint8Array","encryptedEntries","Promise","all","map","entry","name","tagLength","decrypt","decryptedData","buffer","decoded","decodeArray","RemoteEntry","remoteSequence","sha256","digest","hash","sha256String","hashArray","Array","from","hashHex","bytes","toString","padStart","join","layerSubtle","effect","globalThis"],"sources":["../../src/EventLogEncryption.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}