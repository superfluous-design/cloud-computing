{"version":3,"file":"httpClient.js","names":["Cookies","Headers","Client","Error","ClientResponse","IncomingMessage","UrlParams","Context","Effect","FiberRef","globalValue","Inspectable","Option","Stream","HeaderParser","xhrTagKey","xhrTag","GenericTag","currentXHRResponseType","unsafeMake","withXHRArrayBuffer","effect","locally","makeXhr","XMLHttpRequest","makeXMLHttpRequest","make","request","url","signal","fiber","suspend","xhr","getOrElse","getFiberRef","currentContext","addEventListener","abort","onreadystatechange","once","open","method","toString","responseType","Object","entries","headers","forEach","k","v","setRequestHeader","zipRight","sendBody","async","resume","sent","onChange","readyState","succeed","ClientResponseImpl","onerror","_event","fail","RequestError","reason","cause","statusText","void","body","_tag","sync","send","formData","matchEffect","runFold","stream","Uint8Array","acc","chunk","next","length","set","onFailure","onSuccess","encoder","TextEncoder","IncomingMessageImpl","Class","source","onError","TypeId","constructor","_rawHeaderString","getAllResponseHeaders","_rawHeaders","_headers","empty","parser","result","encode","undefined","parsed","fromInput","cachedCookies","cookies","fromSetCookie","remoteAddress","none","_textEffect","text","responseText","onReadyStateChange","removeEventListener","pipe","cached","runSync","json","tryMap","try","_","JSON","parse","catch","urlParamsBody","flatMap","URLSearchParams","emit","offset","single","slice","end","_arrayBufferEffect","arrayBuffer","globalThis","response","map","buffer","ResponseError","status","die","toJSON","inspect","_id","layerXMLHttpRequest","layerMergedContext"],"sources":["../../../src/internal/httpClient.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}