{"version":3,"file":"workerRunner.js","names":["WorkerError","Runner","Cause","Context","Deferred","Effect","ExecStrategy","Exit","FiberSet","identity","globalValue","Layer","Mailbox","Runtime","Scope","cachedPorts","Set","globalHandleConnect","event","add","ports","self","onconnect","make","PlatformRunner","of","PlatformRunnerTypeId","start","fnUntraced","closeLatch","disconnects","currentPortId","Map","send","portId","message","transfer","sync","get","postMessage","run","handler","scope","runtime","interruptible","pipe","updateContext","omit","fiberSet","runFork","onExit","exit","_tag","isInterruptedOnly","cause","unsafeDone","die","squash","onMessage","data","result","isEffect","fiber","addObserver","unsafeAdd","port","size","void","delete","close","onMessageError","error","reason","onError","handlePort","fork","sequential","flatMap","set","onMsg","addEventListener","addFinalizer","removeEventListener","prevOnConnect","clear","layerMessagePort","succeed","layer"],"sources":["../../../src/internal/workerRunner.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}