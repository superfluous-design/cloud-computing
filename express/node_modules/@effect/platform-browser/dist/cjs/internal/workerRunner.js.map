{"version":3,"file":"workerRunner.js","names":["_WorkerError","require","Runner","_interopRequireWildcard","Cause","Context","Deferred","Effect","ExecStrategy","Exit","FiberSet","_Function","_GlobalValue","Layer","Mailbox","Runtime","Scope","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","cachedPorts","globalValue","Set","globalHandleConnect","event","add","ports","self","onconnect","make","PlatformRunner","of","PlatformRunnerTypeId","start","fnUntraced","closeLatch","disconnects","currentPortId","Map","send","portId","message","transfer","sync","postMessage","run","handler","scope","runtime","interruptible","pipe","updateContext","omit","fiberSet","runFork","onExit","exit","_tag","isInterruptedOnly","cause","unsafeDone","die","squash","onMessage","data","result","isEffect","fiber","addObserver","unsafeAdd","port","size","void","delete","close","onMessageError","error","WorkerError","reason","onError","handlePort","fork","sequential","flatMap","onMsg","addEventListener","addFinalizer","removeEventListener","prevOnConnect","clear","identity","exports","layerMessagePort","succeed","layer"],"sources":["../../../src/internal/workerRunner.ts"],"sourcesContent":[null],"mappings":";;;;;;AAAA,IAAAA,YAAA,GAAAC,OAAA;AACA,IAAAC,MAAA,GAAAC,uBAAA,CAAAF,OAAA;AACA,IAAAG,KAAA,GAAAD,uBAAA,CAAAF,OAAA;AACA,IAAAI,OAAA,GAAAF,uBAAA,CAAAF,OAAA;AACA,IAAAK,QAAA,GAAAH,uBAAA,CAAAF,OAAA;AACA,IAAAM,MAAA,GAAAJ,uBAAA,CAAAF,OAAA;AACA,IAAAO,YAAA,GAAAL,uBAAA,CAAAF,OAAA;AACA,IAAAQ,IAAA,GAAAN,uBAAA,CAAAF,OAAA;AACA,IAAAS,QAAA,GAAAP,uBAAA,CAAAF,OAAA;AACA,IAAAU,SAAA,GAAAV,OAAA;AACA,IAAAW,YAAA,GAAAX,OAAA;AACA,IAAAY,KAAA,GAAAV,uBAAA,CAAAF,OAAA;AACA,IAAAa,OAAA,GAAAX,uBAAA,CAAAF,OAAA;AACA,IAAAc,OAAA,GAAAZ,uBAAA,CAAAF,OAAA;AACA,IAAAe,KAAA,GAAAb,uBAAA,CAAAF,OAAA;AAAqC,SAAAE,wBAAAc,CAAA,EAAAC,CAAA,6BAAAC,OAAA,MAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAhB,uBAAA,YAAAA,CAAAc,CAAA,EAAAC,CAAA,SAAAA,CAAA,IAAAD,CAAA,IAAAA,CAAA,CAAAK,UAAA,SAAAL,CAAA,MAAAM,CAAA,EAAAC,CAAA,EAAAC,CAAA,KAAAC,SAAA,QAAAC,OAAA,EAAAV,CAAA,iBAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,SAAAQ,CAAA,MAAAF,CAAA,GAAAL,CAAA,GAAAG,CAAA,GAAAD,CAAA,QAAAG,CAAA,CAAAK,GAAA,CAAAX,CAAA,UAAAM,CAAA,CAAAM,GAAA,CAAAZ,CAAA,GAAAM,CAAA,CAAAO,GAAA,CAAAb,CAAA,EAAAQ,CAAA,gBAAAP,CAAA,IAAAD,CAAA,gBAAAC,CAAA,OAAAa,cAAA,CAAAC,IAAA,CAAAf,CAAA,EAAAC,CAAA,OAAAM,CAAA,IAAAD,CAAA,GAAAU,MAAA,CAAAC,cAAA,KAAAD,MAAA,CAAAE,wBAAA,CAAAlB,CAAA,EAAAC,CAAA,OAAAM,CAAA,CAAAK,GAAA,IAAAL,CAAA,CAAAM,GAAA,IAAAP,CAAA,CAAAE,CAAA,EAAAP,CAAA,EAAAM,CAAA,IAAAC,CAAA,CAAAP,CAAA,IAAAD,CAAA,CAAAC,CAAA,WAAAO,CAAA,KAAAR,CAAA,EAAAC,CAAA;AAErC,MAAMkB,WAAW,gBAAG,IAAAC,wBAAW,EAAC,6CAA6C,EAAE,MAAM,IAAIC,GAAG,EAAe,CAAC;AAC5G,SAASC,mBAAmBA,CAACC,KAAmB;EAC9CJ,WAAW,CAACK,GAAG,CAAED,KAAsB,CAACE,KAAK,CAAC,CAAC,CAAC,CAAC;AACnD;AACA,IAAI,OAAOC,IAAI,KAAK,WAAW,IAAI,WAAW,IAAIA,IAAI,EAAE;EACtDA,IAAI,CAACC,SAAS,GAAGL,mBAAmB;AACtC;AAEA;AACO,MAAMM,IAAI,GAAIF,IAA0B,IAC7CzC,MAAM,CAAC4C,cAAc,CAACC,EAAE,CAAC;EACvB,CAAC7C,MAAM,CAAC8C,oBAAoB,GAAG9C,MAAM,CAAC8C,oBAAoB;EAC1DC,KAAK,EAAE1C,MAAM,CAAC2C,UAAU,CAAC,WAAgBC,UAAgD;IACvF,MAAMC,WAAW,GAAG,OAAOtC,OAAO,CAAC+B,IAAI,EAAU;IACjD,IAAIQ,aAAa,GAAG,CAAC;IAErB,MAAMX,KAAK,GAAG,IAAIY,GAAG,EAAwD;IAC7E,MAAMC,IAAI,GAAGA,CAACC,MAAc,EAAEC,OAAU,EAAEC,QAAiC,KACzEnD,MAAM,CAACoD,IAAI,CAAC,MAAK;MACf;MAAC,CAACjB,KAAK,CAACb,GAAG,CAAC2B,MAAM,CAAC,GAAG,CAAC,CAAC,IAAIb,IAAI,EAAEiB,WAAW,CAAC,CAAC,CAAC,EAAEH,OAAO,CAAC,EAAE;QAC1DC,QAAQ,EAAEA;OACX,CAAC;IACJ,CAAC,CAAC;IAEJ,MAAMG,GAAG,GAAGtD,MAAM,CAAC2C,UAAU,CAAC,WAC5BY,OAAsE;MAEtE,MAAMC,KAAK,GAAG,OAAOxD,MAAM,CAACwD,KAAK;MACjC,MAAMC,OAAO,GAAG,CAAC,OAAOzD,MAAM,CAAC0D,aAAa,CAAC1D,MAAM,CAACyD,OAAO,EAAmB,CAAC,EAAEE,IAAI,CACnFnD,OAAO,CAACoD,aAAa,CAAC9D,OAAO,CAAC+D,IAAI,CAACpD,KAAK,CAACA,KAAK,CAAC,CAAC,CAC3B;MACvB,MAAMqD,QAAQ,GAAG,OAAO3D,QAAQ,CAACmC,IAAI,EAAwB;MAC7D,MAAMyB,OAAO,GAAGvD,OAAO,CAACuD,OAAO,CAACN,OAAO,CAAC;MACxC,SAASO,MAAMA,CAACC,IAAuB;QACrC,IAAIA,IAAI,CAACC,IAAI,KAAK,SAAS,IAAI,CAACrE,KAAK,CAACsE,iBAAiB,CAACF,IAAI,CAACG,KAAK,CAAC,EAAE;UACnErE,QAAQ,CAACsE,UAAU,CAACzB,UAAU,EAAE1C,IAAI,CAACoE,GAAG,CAACzE,KAAK,CAAC0E,MAAM,CAACN,IAAI,CAACG,KAAK,CAAC,CAAC,CAAC;QACrE;MACF;MAEA,SAASI,SAASA,CAACvB,MAAc;QAC/B,OAAO,UAAShB,KAAmB;UACjC,MAAMiB,OAAO,GAAGjB,KAAK,CAACwC,IAAuC;UAC7D,IAAIvB,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE;YACpB,MAAMwB,MAAM,GAAGnB,OAAO,CAACN,MAAM,EAAEC,OAAO,CAAC,CAAC,CAAC,CAAC;YAC1C,IAAIlD,MAAM,CAAC2E,QAAQ,CAACD,MAAM,CAAC,EAAE;cAC3B,MAAME,KAAK,GAAGb,OAAO,CAACW,MAAM,CAAC;cAC7BE,KAAK,CAACC,WAAW,CAACb,MAAM,CAAC;cACzB7D,QAAQ,CAAC2E,SAAS,CAAChB,QAAQ,EAAEc,KAAK,CAAC;YACrC;UACF,CAAC,MAAM;YACL,MAAMG,IAAI,GAAG5C,KAAK,CAACb,GAAG,CAAC2B,MAAM,CAAC;YAC9B,IAAI,CAAC8B,IAAI,EAAE;cACT;YACF,CAAC,MAAM,IAAI5C,KAAK,CAAC6C,IAAI,KAAK,CAAC,EAAE;cAC3B;cACA,OAAOjF,QAAQ,CAACsE,UAAU,CAACzB,UAAU,EAAE1C,IAAI,CAAC+E,IAAI,CAAC;YACnD;YACA9C,KAAK,CAAC+C,MAAM,CAACjC,MAAM,CAAC;YACpBjD,MAAM,CAAC+D,OAAO,CAACtD,KAAK,CAAC0E,KAAK,CAACJ,IAAI,CAAC,CAAC,CAAC,EAAE7E,IAAI,CAAC+E,IAAI,CAAC,CAAC;UACjD;QACF,CAAC;MACH;MACA,SAASG,cAAcA,CAACC,KAAmB;QACzCtF,QAAQ,CAACsE,UAAU,CACjBzB,UAAU,EACV,IAAI0C,wBAAW,CAAC;UAAEC,MAAM,EAAE,QAAQ;UAAEnB,KAAK,EAAEiB,KAAK,CAACZ;QAAI,CAAE,CAAC,CACzD;MACH;MACA,SAASe,OAAOA,CAACH,KAAU;QACzBtF,QAAQ,CAACsE,UAAU,CACjBzB,UAAU,EACV,IAAI0C,wBAAW,CAAC;UAAEC,MAAM,EAAE,SAAS;UAAEnB,KAAK,EAAEiB,KAAK,CAACZ;QAAI,CAAE,CAAC,CAC1D;MACH;MACA,SAASgB,UAAUA,CAACV,IAAiB;QACnC,MAAMH,KAAK,GAAGnE,KAAK,CAACiF,IAAI,CAAClC,KAAK,EAAEvD,YAAY,CAAC0F,UAAU,CAAC,CAAChC,IAAI,CAC3D3D,MAAM,CAAC4F,OAAO,CAAEpC,KAAK,IAAI;UACvB,MAAMP,MAAM,GAAGH,aAAa,EAAE;UAC9BX,KAAK,CAACZ,GAAG,CAAC0B,MAAM,EAAE,CAAC8B,IAAI,EAAEvB,KAAK,CAAC,CAAC;UAChC,MAAMqC,KAAK,GAAGrB,SAAS,CAACvB,MAAM,CAAC;UAC/B8B,IAAI,CAACe,gBAAgB,CAAC,SAAS,EAAED,KAAK,CAAC;UACvCd,IAAI,CAACe,gBAAgB,CAAC,cAAc,EAAEV,cAAc,CAAC;UACrD,IAAI,OAAO,IAAIL,IAAI,EAAE;YACnBA,IAAI,CAACrC,KAAK,EAAE;UACd;UACAqC,IAAI,CAAC1B,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;UACrB,OAAO5C,KAAK,CAACsF,YAAY,CACvBvC,KAAK,EACLxD,MAAM,CAACoD,IAAI,CAAC,MAAK;YACf2B,IAAI,CAACiB,mBAAmB,CAAC,SAAS,EAAEH,KAAK,CAAC;YAC1Cd,IAAI,CAACiB,mBAAmB,CAAC,cAAc,EAAER,OAAO,CAAC;YACjDT,IAAI,CAACI,KAAK,EAAE;UACd,CAAC,CAAC,CACH;QACH,CAAC,CAAC,EACFpB,OAAO,CACR;QACDa,KAAK,CAACC,WAAW,CAACb,MAAM,CAAC;QACzB7D,QAAQ,CAAC2E,SAAS,CAAChB,QAAQ,EAAEc,KAAK,CAAC;MACrC;MACAxC,IAAI,CAAC0D,gBAAgB,CAAC,OAAO,EAAEN,OAAO,CAAC;MACvC,IAAIS,aAAkC;MACtC,IAAI,WAAW,IAAI7D,IAAI,EAAE;QACvB6D,aAAa,GAAG7D,IAAI,CAACC,SAAS;QAC9BD,IAAI,CAACC,SAAS,GAAG,UAASJ,KAAmB;UAC3C,MAAM8C,IAAI,GAAI9C,KAAsB,CAACE,KAAK,CAAC,CAAC,CAAC;UAC7CsD,UAAU,CAACV,IAAI,CAAC;QAClB,CAAC;QACD,KAAK,MAAMA,IAAI,IAAIlD,WAAW,EAAE;UAC9B4D,UAAU,CAACV,IAAI,CAAC;QAClB;QACAlD,WAAW,CAACqE,KAAK,EAAE;QACnB,OAAOzF,KAAK,CAACsF,YAAY,CACvBvC,KAAK,EACLxD,MAAM,CAACoD,IAAI,CAAC,MAAMhB,IAAI,CAAC+C,KAAK,EAAE,CAAC,CAChC;MACH,CAAC,MAAM;QACLM,UAAU,CAACrD,IAAW,CAAC;MACzB;MACA,OAAO3B,KAAK,CAACsF,YAAY,CACvBvC,KAAK,EACLxD,MAAM,CAACoD,IAAI,CAAC,MAAK;QACfhB,IAAI,CAAC4D,mBAAmB,CAAC,OAAO,EAAER,OAAO,CAAC;QAC1C,IAAI,WAAW,IAAIpD,IAAI,EAAE;UACvBA,IAAI,CAACC,SAAS,GAAG4D,aAAa;QAChC;MACF,CAAC,CAAC,CACH;IACH,CAAC,CAAC;IAEF,OAAO,IAAAE,kBAAQ,EAA6B;MAAE7C,GAAG;MAAEN,IAAI;MAAEH;IAAW,CAAE,CAAC;EACzE,CAAC;CACF,CAAC;AAEJ;AAAAuD,OAAA,CAAA9D,IAAA,GAAAA,IAAA;AACO,MAAM+D,gBAAgB,GAAItB,IAA0B,IAAKzE,KAAK,CAACgG,OAAO,CAAC3G,MAAM,CAAC4C,cAAc,EAAED,IAAI,CAACyC,IAAI,CAAC,CAAC;AAEhH;AAAAqB,OAAA,CAAAC,gBAAA,GAAAA,gBAAA;AACO,MAAME,KAAK,GAAAH,OAAA,CAAAG,KAAA,gBAAGjG,KAAK,CAAC8C,IAAI,CAACzD,MAAM,CAAC4C,cAAc,EAAE,MAAMD,IAAI,CAACF,IAAI,CAAC,CAAC","ignoreList":[]}