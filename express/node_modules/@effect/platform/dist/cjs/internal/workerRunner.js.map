{"version":3,"file":"workerRunner.js","names":["Cause","_interopRequireWildcard","require","Chunk","Context","Deferred","Effect","Either","Fiber","FiberId","_Function","Layer","Schema","Stream","Transferable","_WorkerError","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","PlatformRunnerTypeId","exports","Symbol","for","PlatformRunner","GenericTag","CloseLatch","Reference","defaultValue","unsafeMake","none","layerCloseLatch","effect","make","fnUntraced","process","options","fiber","withFiberRuntime","succeed","platform","closeLatch","backing","start","fiberMap","Map","await","pipe","onExit","currentScheduler","scheduleTask","unsafeInterruptAsFork","id","void","forkScoped","run","portId","kind","data","span","interrupt","decode","flatMap","input","collector","unsafeMakeCollector","stream","isEffect","out","encodeOutput","provideService","Collector","payload","send","unsafeRead","runForEachChunk","chunk","undefined","toReadonlyArray","unsafeClear","forEach","andThen","withParentSpan","_tag","traceId","spanId","sampled","context","empty","uninterruptibleMask","restore","catchIf","isWorkerError","error","WorkerError","encodeCause","fail","catchAllCause","cause","match","failureOrCause","onLeft","encodeError","onRight","ensuring","sync","delete","layer","scopedDiscard","provide","makeSerialized","schema","handlers","gen","scope","parseRequest","decodeUnknown","request","result","isLayer","buildWithScope","_","merge","provideContext","message","mapError","reason","serializeFailure","serializeSuccess","layerSerialized","launch","scopedWith","provideMerge"],"sources":["../../../src/internal/workerRunner.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}